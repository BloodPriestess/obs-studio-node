environment:
  NodeVersion: 8
  SLBuildDirectory: streamlabs-build
  SLRuntime: electron
  SLRuntimeVersion: 1.7.11
  SLGenerator: Visual Studio 14 2015 Win64
  SLDistributeDirectory: distribute
  SLArch: x64
  SLArtifact: streamlabs-x86_64
  
install:
  - ps: Install-Product node $env:NodeVersion
  - yarn install

build_script:
  - yarn run cmake-js configure --out "%SLBuildDirectory%" -r="%SLRuntime%" -v="%SLRuntimeVersion%" -G"%SLGenerator%" -a "%SLArch%" --CDCMAKE_INSTALL_PREFIX="%SLDistributeDirectory%\obs-studio-node"
  - cmake --build %SLBuildDirectory% --target install --config Release

after_build:
  - tar cvaf "%SLArtifact%.tar.gz" -C "%SLBuildDirectory%\%SLDistributeDirectory%" "obs-studio-node"

artifacts:
  - path: $(SLArtifact)
    name: Streamlabs Aritfact

test: off